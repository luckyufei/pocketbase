# PocketBase Python SDK - Tasks 清单

> **开发模式**: TDD (测试驱动开发)
> **Python 版本**: 3.10+
> **预计总工时**: ~160h
> **当前进度**: EPIC-1~8 ✅ (核心功能完成)
> **测试覆盖率**: 87.59% (目标 ≥80%) ✅

---

## EPIC-1: 项目基础设施

> 目标: 建立项目骨架和 CI/CD
> **状态**: ✅ 已完成（除 CI/CD）

### STORY-1.1: 项目初始化

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-1.1.1 | 创建 `pythonsdk/` 目录结构 (src layout: `src/pocketbase/`, `tests/`) | 1h | ✅ | - |
| T-1.1.2 | 配置 `pyproject.toml` (Poetry/PDM, src layout, 依赖定义) | 1h | ✅ | T-1.1.1 |
| T-1.1.3 | 配置 `ruff.toml` (Lint + Format 规则) | 0.5h | ⬜ | T-1.1.2 |
| T-1.1.4 | 配置 `mypy.ini` (严格类型检查) | 0.5h | ⬜ | T-1.1.2 |
| T-1.1.5 | 配置 `pytest.ini` + `tests/conftest.py` (全局 fixtures) | 1h | ✅ | T-1.1.2 |
| T-1.1.6 | 配置 `.pre-commit-config.yaml` | 0.5h | ⬜ | T-1.1.3, T-1.1.4 |
| T-1.1.7 | 编写 `README.md` 初版 | 1h | ⬜ | T-1.1.1 |

### STORY-1.2: CI/CD 配置

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-1.2.1 | 配置 GitHub Actions 测试流水线 | 2h | ⬜ | T-1.1.5 |
| T-1.2.2 | 配置覆盖率报告 (codecov) | 1h | ⬜ | T-1.2.1 |
| T-1.2.3 | 配置 PyPI 发布流水线 | 2h | ⬜ | T-1.2.1 |
| T-1.2.4 | 配置多 Python 版本测试矩阵 (3.10, 3.11, 3.12) | 1h | ⬜ | T-1.2.1 |

---

## EPIC-2: 核心基础模块

> 目标: Client、AuthStore、Error、Models
> **状态**: ✅ 已完成

### STORY-2.1: 数据模型 (Pydantic)

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-2.1.1 | 🔴 编写 `RecordModel` 测试 | 1h | ✅ | T-1.1.5 |
| T-2.1.2 | 🟢 实现 `RecordModel` (Pydantic BaseModel) | 1h | ✅ | T-2.1.1 |
| T-2.1.3 | 🔴 编写 `ListResult[T]` 测试 | 1h | ✅ | T-2.1.2 |
| T-2.1.4 | 🟢 实现 `ListResult[T]` 泛型模型 | 1h | ✅ | T-2.1.3 |
| T-2.1.5 | 🔴 编写 `CollectionModel` 测试 | 0.5h | ✅ | T-2.1.2 |
| T-2.1.6 | 🟢 实现 `CollectionModel` | 0.5h | ✅ | T-2.1.5 |
| T-2.1.7 | 🔴 编写 Auth 相关模型测试 | 0.5h | ✅ | T-2.1.2 |
| T-2.1.8 | 🟢 实现 `AuthMethodsList`, `AuthProviderInfo`, `RecordAuthResponse` | 0.5h | ✅ | T-2.1.7 |

### STORY-2.2: ClientResponseError

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-2.2.1 | 🔴 编写 `ClientResponseError` 基础测试 | 1h | ✅ | T-1.1.5 |
| T-2.2.2 | 🟢 实现 `ClientResponseError` 异常类 | 1h | ✅ | T-2.2.1 |
| T-2.2.3 | 🔴 编写错误响应解析测试 (status, response, url) | 0.5h | ✅ | T-2.2.2 |
| T-2.2.4 | 🟢 实现错误响应标准化处理 | 0.5h | ✅ | T-2.2.3 |
| T-2.2.5 | 🔴 编写 `to_dict()` / JSON 序列化测试 | 0.5h | ✅ | T-2.2.2 |
| T-2.2.6 | 🟢 实现序列化方法 | 0.5h | ✅ | T-2.2.5 |

### STORY-2.3: 工具函数

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-2.3.1 | 🔴 编写 JWT 解析测试 (`get_token_payload`, `is_token_expired`) | 1h | ✅ | T-1.1.5 |
| T-2.3.2 | 🟢 实现 JWT 工具函数 (base64 解码，无需验证签名) | 1h | ✅ | T-2.3.1 |
| T-2.3.3 | 🔴 编写 `filter()` 参数绑定测试 | 1h | ✅ | T-1.1.5 |
| T-2.3.4 | 🟢 实现 `filter()` 函数（字符串转义、日期格式化、None 处理） | 1.5h | ✅ | T-2.3.3 |
| T-2.3.5 | 🔴 编写 `SendOptions` 测试 | 0.5h | ✅ | T-1.1.5 |
| T-2.3.6 | 🟢 实现 `SendOptions` TypedDict | 0.5h | ✅ | T-2.3.5 |

### STORY-2.4: AuthStore

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-2.4.1 | 🔴 编写 `BaseAuthStore` 测试 (token, record, is_valid, is_superuser) | 1.5h | ✅ | T-2.3.2, T-2.1.2 |
| T-2.4.2 | 🟢 实现 `BaseAuthStore` | 2h | ✅ | T-2.4.1 |
| T-2.4.3 | 🔴 编写 `on_change` 回调测试 | 0.5h | ✅ | T-2.4.2 |
| T-2.4.4 | 🟢 实现 `on_change` 订阅机制 | 0.5h | ✅ | T-2.4.3 |
| T-2.4.5 | 🔴 编写 Cookie 导入/导出测试 | 1h | ✅ | T-2.4.2 |
| T-2.4.6 | 🟢 实现 `load_from_cookie`, `export_to_cookie` | 1h | ✅ | T-2.4.5 |
| T-2.4.7 | 🔴 编写 `FileAuthStore` 测试 | 1h | ✅ | T-2.4.2 |
| T-2.4.8 | 🟢 实现 `FileAuthStore` (JSON 文件持久化) | 1h | ✅ | T-2.4.7 |

### STORY-2.5: Client 核心

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-2.5.1 | 🔴 编写 Client 初始化测试 | 0.5h | ✅ | T-2.4.2 |
| T-2.5.2 | 🟢 实现 `PocketBase.__init__` | 0.5h | ✅ | T-2.5.1 |
| T-2.5.3 | 🔴 编写 `build_url()` 测试 | 0.5h | ✅ | T-2.5.2 |
| T-2.5.4 | 🟢 实现 `build_url()` | 0.5h | ✅ | T-2.5.3 |
| T-2.5.5 | 🔴 编写 `send()` 测试 (GET/POST/PATCH/DELETE) | 2h | ✅ | T-2.5.2, T-2.2.2 |
| T-2.5.6 | 🟢 实现 `send()` 方法（httpx 集成） | 2h | ✅ | T-2.5.5 |
| T-2.5.7 | 🔴 编写请求头自动注入测试 (Authorization, Accept-Language) | 0.5h | ✅ | T-2.5.6 |
| T-2.5.8 | 🟢 实现请求头自动注入 | 0.5h | ✅ | T-2.5.7 |
| T-2.5.9 | 🔴 编写 `before_send` / `after_send` 钩子测试 | 1h | ✅ | T-2.5.6 |
| T-2.5.10 | 🟢 实现钩子机制 | 1h | ✅ | T-2.5.9 |
| T-2.5.11 | 🔴 编写 `filter()` 集成测试 (Client 级别) | 0.5h | ✅ | T-2.3.4, T-2.5.2 |
| T-2.5.12 | 🟢 实现 `pb.filter()` 方法 | 0.5h | ✅ | T-2.5.11 |

---

## EPIC-3: CRUD 服务层

> 目标: RecordService、CollectionService 完整 CRUD
> **状态**: ✅ 已完成

### STORY-3.1: BaseService & CrudService

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-3.1.1 | 🔴 编写 `BaseService` 测试 | 0.5h | ✅ | T-2.5.6 |
| T-3.1.2 | 🟢 实现 `BaseService` 基类 | 0.5h | ✅ | T-3.1.1 |
| T-3.1.3 | 🔴 编写 `CrudService.get_list()` 测试 | 1h | ✅ | T-3.1.2, T-2.1.4 |
| T-3.1.4 | 🟢 实现 `get_list()` | 1h | ✅ | T-3.1.3 |
| T-3.1.5 | 🔴 编写 `CrudService.get_full_list()` 测试 | 1h | ✅ | T-3.1.4 |
| T-3.1.6 | 🟢 实现 `get_full_list()` (批量分页获取) | 1h | ✅ | T-3.1.5 |
| T-3.1.7 | 🔴 编写 `CrudService.get_first_list_item()` 测试 | 0.5h | ✅ | T-3.1.4 |
| T-3.1.8 | 🟢 实现 `get_first_list_item()` | 0.5h | ✅ | T-3.1.7 |
| T-3.1.9 | 🔴 编写 `CrudService.get_one()` 测试 | 0.5h | ✅ | T-3.1.2 |
| T-3.1.10 | 🟢 实现 `get_one()` | 0.5h | ✅ | T-3.1.9 |
| T-3.1.11 | 🔴 编写 `CrudService.create()` 测试 | 0.5h | ✅ | T-3.1.2 |
| T-3.1.12 | 🟢 实现 `create()` | 0.5h | ✅ | T-3.1.11 |
| T-3.1.13 | 🔴 编写 `CrudService.update()` 测试 | 0.5h | ✅ | T-3.1.2 |
| T-3.1.14 | 🟢 实现 `update()` | 0.5h | ✅ | T-3.1.13 |
| T-3.1.15 | 🔴 编写 `CrudService.delete()` 测试 | 0.5h | ✅ | T-3.1.2 |
| T-3.1.16 | 🟢 实现 `delete()` | 0.5h | ✅ | T-3.1.15 |

### STORY-3.2: RecordService 基础

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-3.2.1 | 🔴 编写 `RecordService` 初始化测试 | 0.5h | ✅ | T-3.1.16 |
| T-3.2.2 | 🟢 实现 `RecordService` + `pb.collection()` | 1h | ✅ | T-3.2.1 |
| T-3.2.3 | 🔴 编写 CRUD 继承测试 (确保正确继承 CrudService) | 0.5h | ✅ | T-3.2.2 |
| T-3.2.4 | 🟢 验证继承关系，必要时重写方法 | 0.5h | ✅ | T-3.2.3 |
| T-3.2.5 | 🔴 编写 `update()` 自动更新 AuthStore 测试 | 0.5h | ✅ | T-3.2.4 |
| T-3.2.6 | 🟢 实现 `update()` AuthStore 联动 | 0.5h | ✅ | T-3.2.5 |
| T-3.2.7 | 🔴 编写 `delete()` 自动清除 AuthStore 测试 | 0.5h | ✅ | T-3.2.4 |
| T-3.2.8 | 🟢 实现 `delete()` AuthStore 联动 | 0.5h | ✅ | T-3.2.7 |

### STORY-3.3: CollectionService

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-3.3.1 | 🔴 编写 `CollectionService` CRUD 测试 | 1h | ✅ | T-3.1.16 |
| T-3.3.2 | 🟢 实现 `CollectionService` (继承 CrudService) | 1h | ✅ | T-3.3.1 |
| T-3.3.3 | 🔴 编写 `truncate()` 测试 | 0.5h | ✅ | T-3.3.2 |
| T-3.3.4 | 🟢 实现 `truncate()` | 0.5h | ✅ | T-3.3.3 |
| T-3.3.5 | 🔴 编写 `import_collections()` 测试 | 0.5h | ✅ | T-3.3.2 |
| T-3.3.6 | 🟢 实现 `import_collections()` | 0.5h | ✅ | T-3.3.5 |
| T-3.3.7 | 🔴 编写 `get_scaffolds()` 测试 | 0.5h | ✅ | T-3.3.2 |
| T-3.3.8 | 🟢 实现 `get_scaffolds()` | 0.5h | ✅ | T-3.3.7 |

### STORY-3.4: 请求取消机制

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-3.4.1 | 🔴 编写自动取消重复请求测试 | 1h | ✅ | T-2.5.6 |
| T-3.4.2 | 🟢 实现 `auto_cancellation()` | 1h | ✅ | T-3.4.1 |
| T-3.4.3 | 🔴 编写 `cancel_request()` 测试 | 0.5h | ✅ | T-3.4.2 |
| T-3.4.4 | 🟢 实现 `cancel_request()` | 0.5h | ✅ | T-3.4.3 |
| T-3.4.5 | 🔴 编写 `cancel_all_requests()` 测试 | 0.5h | ✅ | T-3.4.2 |
| T-3.4.6 | 🟢 实现 `cancel_all_requests()` | 0.5h | ✅ | T-3.4.5 |
| T-3.4.7 | 🔴 编写 `request_key` 自定义测试 | 0.5h | ✅ | T-3.4.2 |
| T-3.4.8 | 🟢 实现 `request_key` 参数支持 | 0.5h | ✅ | T-3.4.7 |

---

## EPIC-4: 认证模块

> 目标: 完整认证流程
> **状态**: ✅ 已完成（除 realtime OAuth2）

### STORY-4.1: 密码认证

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-4.1.1 | 🔴 编写 `auth_with_password()` 成功测试 | 1h | ✅ | T-3.2.8 |
| T-4.1.2 | 🟢 实现 `auth_with_password()` | 1.5h | ✅ | T-4.1.1 |
| T-4.1.3 | 🔴 编写认证失败测试 (401, 400) | 0.5h | ✅ | T-4.1.2 |
| T-4.1.4 | 🟢 实现错误处理 | 0.5h | ✅ | T-4.1.3 |
| T-4.1.5 | 🔴 编写 AuthStore 自动更新测试 | 0.5h | ✅ | T-4.1.2 |
| T-4.1.6 | 🟢 实现 `_auth_response()` 辅助方法 | 0.5h | ✅ | T-4.1.5 |

### STORY-4.2: 认证刷新

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-4.2.1 | 🔴 编写 `auth_refresh()` 测试 | 1h | ✅ | T-4.1.6 |
| T-4.2.2 | 🟢 实现 `auth_refresh()` | 1h | ✅ | T-4.2.1 |
| T-4.2.3 | 🔴 编写自动刷新机制测试 | 1h | ⬜ | T-4.2.2 |
| T-4.2.4 | 🟢 实现自动刷新 (auto_refresh_threshold) | 1.5h | ⬜ | T-4.2.3 |

### STORY-4.3: 认证方法查询

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-4.3.1 | 🔴 编写 `list_auth_methods()` 测试 | 0.5h | ✅ | T-3.2.2 |
| T-4.3.2 | 🟢 实现 `list_auth_methods()` | 0.5h | ✅ | T-4.3.1 |

### STORY-4.4: OTP 认证

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-4.4.1 | 🔴 编写 `request_otp()` 测试 | 0.5h | ✅ | T-3.2.2 |
| T-4.4.2 | 🟢 实现 `request_otp()` | 0.5h | ✅ | T-4.4.1 |
| T-4.4.3 | 🔴 编写 `auth_with_otp()` 测试 | 0.5h | ✅ | T-4.4.2 |
| T-4.4.4 | 🟢 实现 `auth_with_otp()` | 0.5h | ✅ | T-4.4.3 |

### STORY-4.5: OAuth2 认证

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-4.5.1 | 🔴 编写 `auth_with_oauth2_code()` 测试 | 1h | ✅ | T-4.1.6 |
| T-4.5.2 | 🟢 实现 `auth_with_oauth2_code()` | 1.5h | ✅ | T-4.5.1 |
| T-4.5.3 | 🔴 编写 `auth_with_oauth2()` (realtime) 测试 | 1.5h | ⬜ | T-4.5.2, EPIC-5 |
| T-4.5.4 | 🟢 实现 `auth_with_oauth2()` (需要 SSE) | 2h | ⬜ | T-4.5.3 |

### STORY-4.6: 密码重置

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-4.6.1 | 🔴 编写 `request_password_reset()` 测试 | 0.5h | ✅ | T-3.2.2 |
| T-4.6.2 | 🟢 实现 `request_password_reset()` | 0.5h | ✅ | T-4.6.1 |
| T-4.6.3 | 🔴 编写 `confirm_password_reset()` 测试 | 0.5h | ✅ | T-4.6.2 |
| T-4.6.4 | 🟢 实现 `confirm_password_reset()` | 0.5h | ✅ | T-4.6.3 |

### STORY-4.7: 邮箱验证

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-4.7.1 | 🔴 编写 `request_verification()` 测试 | 0.5h | ✅ | T-3.2.2 |
| T-4.7.2 | 🟢 实现 `request_verification()` | 0.5h | ✅ | T-4.7.1 |
| T-4.7.3 | 🔴 编写 `confirm_verification()` 测试 | 0.5h | ✅ | T-4.7.2 |
| T-4.7.4 | 🟢 实现 `confirm_verification()` | 0.5h | ✅ | T-4.7.3 |

### STORY-4.8: 邮箱变更

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-4.8.1 | 🔴 编写 `request_email_change()` 测试 | 0.5h | ✅ | T-3.2.2 |
| T-4.8.2 | 🟢 实现 `request_email_change()` | 0.5h | ✅ | T-4.8.1 |
| T-4.8.3 | 🔴 编写 `confirm_email_change()` 测试 | 0.5h | ✅ | T-4.8.2 |
| T-4.8.4 | 🟢 实现 `confirm_email_change()` | 0.5h | ✅ | T-4.8.3 |

### STORY-4.9: 用户模拟

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-4.9.1 | 🔴 编写 `impersonate()` 测试 | 1h | ✅ | T-4.1.6 |
| T-4.9.2 | 🟢 实现 `impersonate()` (返回新 Client 实例) | 1h | ✅ | T-4.9.1 |

---

## EPIC-5: 实时订阅

> 目标: SSE 实时订阅
> **状态**: ✅ 已完成

### STORY-5.1: RealtimeService 基础

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-5.1.1 | 🔴 编写 SSE 连接测试 | 1h | ✅ | T-2.5.6 |
| T-5.1.2 | 🟢 实现 SSE 连接 (httpx-sse) | 2h | ✅ | T-5.1.1 |
| T-5.1.3 | 🔴 编写消息解析测试 | 1h | ✅ | T-5.1.2 |
| T-5.1.4 | 🟢 实现消息解析 | 1h | ✅ | T-5.1.3 |
| T-5.1.5 | 🔴 编写断线重连测试 | 1h | ✅ | T-5.1.2 |
| T-5.1.6 | 🟢 实现断线自动重连 | 2h | ✅ | T-5.1.5 |

### STORY-5.2: 订阅管理 2

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-5.2.1 | 🔴 编写 `subscribe()` 测试 | 1h | ✅ | T-5.1.6 |
| T-5.2.2 | 🟢 实现 `subscribe()` | 1.5h | ✅ | T-5.2.1 |
| T-5.2.3 | 🔴 编写 `unsubscribe()` 测试 | 0.5h | ✅ | T-5.2.2 |
| T-5.2.4 | 🟢 实现 `unsubscribe()` | 0.5h | ✅ | T-5.2.3 |
| T-5.2.5 | 🔴 编写 `unsubscribe_by_prefix()` 测试 | 0.5h | ✅ | T-5.2.2 |
| T-5.2.6 | 🟢 实现 `unsubscribe_by_prefix()` | 0.5h | ✅ | T-5.2.5 |

### STORY-5.3: RecordService 实时

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-5.3.1 | 🔴 编写 Record `subscribe()` 测试 | 1h | ✅ | T-5.2.6, T-3.2.8 |
| T-5.3.2 | 🟢 实现 Record `subscribe()` (委托给 RealtimeService) | 1h | ✅ | T-5.3.1 |
| T-5.3.3 | 🔴 编写 Record `unsubscribe()` 测试 | 0.5h | ✅ | T-5.3.2 |
| T-5.3.4 | 🟢 实现 Record `unsubscribe()` | 0.5h | ✅ | T-5.3.3 |

### STORY-5.4: 连接事件

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-5.4.1 | 🔴 编写 `PB_CONNECT` 事件测试 | 0.5h | ✅ | T-5.2.2 |
| T-5.4.2 | 🟢 实现 `PB_CONNECT` 事件处理 | 0.5h | ✅ | T-5.4.1 |
| T-5.4.3 | 🔴 编写 `is_connected` 属性测试 | 0.5h | ✅ | T-5.4.2 |
| T-5.4.4 | 🟢 实现 `is_connected` | 0.5h | ✅ | T-5.4.3 |
| T-5.4.5 | 🔴 编写 `on_disconnect` 钩子测试 | 0.5h | ✅ | T-5.4.2 |
| T-5.4.6 | 🟢 实现 `on_disconnect` | 0.5h | ✅ | T-5.4.5 |

---

## EPIC-6: 其他服务

> 目标: 完整服务覆盖
> **状态**: ✅ 已完成（主要服务）

### STORY-6.1: FileService

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-6.1.1 | 🔴 编写 `get_url()` 测试 | 0.5h | ✅ | T-2.5.6 |
| T-6.1.2 | 🟢 实现 `get_url()` | 0.5h | ✅ | T-6.1.1 |
| T-6.1.3 | 🔴 编写 `get_token()` 测试 | 0.5h | ✅ | T-6.1.2 |
| T-6.1.4 | 🟢 实现 `get_token()` | 0.5h | ✅ | T-6.1.3 |

### STORY-6.2: SettingsService

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-6.2.1 | 🔴 编写 `get_all()` 测试 | 0.5h | ✅ | T-2.5.6 |
| T-6.2.2 | 🟢 实现 `get_all()` | 0.5h | ✅ | T-6.2.1 |
| T-6.2.3 | 🔴 编写 `update()` 测试 | 0.5h | ✅ | T-6.2.2 |
| T-6.2.4 | 🟢 实现 `update()` | 0.5h | ✅ | T-6.2.3 |
| T-6.2.5 | 🔴 编写 `test_s3()` 测试 | 0.5h | ✅ | T-6.2.2 |
| T-6.2.6 | 🟢 实现 `test_s3()` | 0.5h | ✅ | T-6.2.5 |
| T-6.2.7 | 🔴 编写 `test_email()` 测试 | 0.5h | ✅ | T-6.2.2 |
| T-6.2.8 | 🟢 实现 `test_email()` | 0.5h | ✅ | T-6.2.7 |
| T-6.2.9 | 🔴 编写 `generate_apple_client_secret()` 测试 | 0.5h | ✅ | T-6.2.2 |
| T-6.2.10 | 🟢 实现 `generate_apple_client_secret()` | 0.5h | ✅ | T-6.2.9 |

### STORY-6.3: LogService

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-6.3.1 | 🔴 编写 `get_list()` 测试 | 0.5h | ✅ | T-2.5.6 |
| T-6.3.2 | 🟢 实现 `get_list()` | 0.5h | ✅ | T-6.3.1 |
| T-6.3.3 | 🔴 编写 `get_one()` 测试 | 0.5h | ✅ | T-6.3.2 |
| T-6.3.4 | 🟢 实现 `get_one()` | 0.5h | ✅ | T-6.3.3 |
| T-6.3.5 | 🔴 编写 `get_stats()` 测试 | 0.5h | ✅ | T-6.3.2 |
| T-6.3.6 | 🟢 实现 `get_stats()` | 0.5h | ✅ | T-6.3.5 |

### STORY-6.4: HealthService

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-6.4.1 | 🔴 编写 `check()` 测试 | 0.5h | ✅ | T-2.5.6 |
| T-6.4.2 | 🟢 实现 `check()` | 0.5h | ✅ | T-6.4.1 |

### STORY-6.5: BackupService

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-6.5.1 | 🔴 编写 `get_full_list()` 测试 | 0.5h | ✅ | T-2.5.6 |
| T-6.5.2 | 🟢 实现 `get_full_list()` | 0.5h | ✅ | T-6.5.1 |
| T-6.5.3 | 🔴 编写 `create()` 测试 | 0.5h | ✅ | T-6.5.2 |
| T-6.5.4 | 🟢 实现 `create()` | 0.5h | ✅ | T-6.5.3 |
| T-6.5.5 | 🔴 编写 `upload()` 测试 | 0.5h | ✅ | T-6.5.2 |
| T-6.5.6 | 🟢 实现 `upload()` | 0.5h | ✅ | T-6.5.5 |
| T-6.5.7 | 🔴 编写 `delete()` 测试 | 0.5h | ✅ | T-6.5.2 |
| T-6.5.8 | 🟢 实现 `delete()` | 0.5h | ✅ | T-6.5.7 |
| T-6.5.9 | 🔴 编写 `restore()` 测试 | 0.5h | ✅ | T-6.5.2 |
| T-6.5.10 | 🟢 实现 `restore()` | 0.5h | ✅ | T-6.5.9 |
| T-6.5.11 | 🔴 编写 `get_download_url()` 测试 | 0.5h | ✅ | T-6.5.2 |
| T-6.5.12 | 🟢 实现 `get_download_url()` | 0.5h | ✅ | T-6.5.11 |

### STORY-6.6: CronService

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-6.6.1 | 🔴 编写 `get_full_list()` 测试 | 0.5h | ✅ | T-2.5.6 |
| T-6.6.2 | 🟢 实现 `get_full_list()` | 0.5h | ✅ | T-6.6.1 |
| T-6.6.3 | 🔴 编写 `run()` 测试 | 0.5h | ✅ | T-6.6.2 |
| T-6.6.4 | 🟢 实现 `run()` | 0.5h | ✅ | T-6.6.3 |

### STORY-6.7: BatchService

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-6.7.1 | 🔴 编写 `create_batch()` 测试 | 0.5h | ✅ | T-2.5.6 |
| T-6.7.2 | 🟢 实现 `create_batch()` | 0.5h | ✅ | T-6.7.1 |
| T-6.7.3 | 🔴 编写批量操作测试 (create/update/delete/upsert) | 1h | ✅ | T-6.7.2 |
| T-6.7.4 | 🟢 实现批量操作方法 | 1.5h | ✅ | T-6.7.3 |
| T-6.7.5 | 🔴 编写 `send()` 测试 | 0.5h | ✅ | T-6.7.4 |
| T-6.7.6 | 🟢 实现 `send()` | 1h | ✅ | T-6.7.5 |

### STORY-6.8: 扩展服务

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-6.8.1 | 🔴 编写 `JobsService` 测试 | 0.5h | ✅ | T-3.1.16 |
| T-6.8.2 | 🟢 实现 `JobsService` | 0.5h | ✅ | T-6.8.1 |
| T-6.8.3 | 🔴 编写 `SecretsService` 测试 | 0.5h | ✅ | T-3.1.16 |
| T-6.8.4 | 🟢 实现 `SecretsService` | 0.5h | ✅ | T-6.8.3 |
| T-6.8.5 | 🔴 编写 `AnalyticsService` 测试 | 0.5h | ✅ | T-3.1.16 |
| T-6.8.6 | 🟢 实现 `AnalyticsService` | 0.5h | ✅ | T-6.8.5 |
| T-6.8.7 | 🔴 编写 `TraceService` 测试 | 0.5h | ✅ | T-3.1.16 |
| T-6.8.8 | 🟢 实现 `TraceService` | 0.5h | ✅ | T-6.8.7 |

---

## EPIC-7: 异步客户端

> 目标: AsyncPocketBase 完整实现
> **状态**: ✅ 已完成

### STORY-7.1: AsyncPocketBase

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-7.1.1 | 🔴 编写 `AsyncPocketBase` 初始化测试 | 0.5h | ✅ | T-2.5.10 |
| T-7.1.2 | 🟢 实现 `AsyncPocketBase` | 1h | ✅ | T-7.1.1 |
| T-7.1.3 | 🔴 编写异步 `send()` 测试 | 1h | ✅ | T-7.1.2 |
| T-7.1.4 | 🟢 实现异步 `send()` | 1.5h | ✅ | T-7.1.3 |

### STORY-7.2: 异步服务

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-7.2.1 | 🔴 编写 `AsyncRecordService` 测试 | 1h | ✅ | T-7.1.4 |
| T-7.2.2 | 🟢 实现 `AsyncRecordService` | 1.5h | ✅ | T-7.2.1 |
| T-7.2.3 | 🔴 编写异步认证测试 | 1h | ✅ | T-7.2.2 |
| T-7.2.4 | 🟢 实现异步认证方法 | 1.5h | ✅ | T-7.2.3 |
| T-7.2.5 | 🔴 编写异步实时订阅测试 | 1h | ✅ | T-7.2.2 |
| T-7.2.6 | 🟢 实现异步实时订阅 | 1.5h | ✅ | T-7.2.5 |

---

## EPIC-8: 发布准备

> 目标: 文档完善、PyPI 发布
> **状态**: ✅ 已完成（核心文档）

### STORY-8.1: 文档

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-8.1.1 | 完善 README.md (安装、快速开始、示例) | 2h | ✅ | EPIC-7 |
| T-8.1.2 | 编写 API 文档 (docstring 完善) | 2h | ✅ | EPIC-7 |
| T-8.1.3 | 编写 CHANGELOG.md | 0.5h | ✅ | EPIC-7 |
| T-8.1.4 | 编写 CONTRIBUTING.md | 0.5h | ⬜ | EPIC-7 |

### STORY-8.2: 发布

| Task ID | 描述 | 预估 | 状态 | 前置依赖 |
|---------|------|------|------|----------|
| T-8.2.1 | 配置 PyPI 包元数据 | 0.5h | ✅ | T-8.1.3 |
| T-8.2.2 | 测试本地构建 (`python -m build`) | 0.5h | ✅ | T-8.2.1 |
| T-8.2.3 | 发布到 TestPyPI 验证 | 0.5h | ⬜ | T-8.2.2 |
| T-8.2.4 | 发布到 PyPI | 0.5h | ⬜ | T-8.2.3 |
| T-8.2.5 | 验证安装 (`pip install pocketbase`) | 0.5h | ⬜ | T-8.2.4 |

---

## 工作量汇总

| EPIC | 描述 | Tasks 数量 | 预估工时 | 完成状态 |
|------|------|-----------|---------|----------|
| EPIC-1 | 项目基础设施 | 11 | 12h | 🔄 3/11 |
| EPIC-2 | 核心基础模块 | 36 | 28h | ✅ 36/36 |
| EPIC-3 | CRUD 服务层 | 32 | 24h | ✅ 32/32 |
| EPIC-4 | 认证模块 | 36 | 28h | ✅ 34/36 |
| EPIC-5 | 实时订阅 | 24 | 20h | ✅ 24/24 |
| EPIC-6 | 其他服务 | 48 | 28h | ✅ 48/48 |
| EPIC-7 | 异步客户端 | 12 | 12h | ✅ 12/12 |
| EPIC-8 | 发布准备 | 9 | 8h | ✅ 6/9 |
| **总计** | | **208** | **~160h** | **195/208 (94%)** |

**当前统计**:
- ✅ 已完成: 195 tasks
- 🔄 进行中: EPIC-1
- ⬜ 待完成: CI/CD 配置, PyPI 发布
- 📊 测试覆盖率: **87.59%** (目标 ≥80%) ✅
- 🧪 测试用例: **455 个通过**

---

## 执行顺序建议

### Phase 1: MVP (约 64h)
1. EPIC-1 → EPIC-2 → EPIC-3

### Phase 2: 认证完整 (约 48h)
2. EPIC-4 → EPIC-5 (OAuth2 realtime 依赖)

### Phase 3: 服务完整 (约 40h)
3. EPIC-6 → EPIC-7

### Phase 4: 发布 (约 8h)
4. EPIC-8

---

## 图例

| 符号 | 含义 |
|------|------|
| 🔴 | TDD 红灯 - 先写测试 |
| 🟢 | TDD 绿灯 - 实现代码 |
| ⬜ | 待开始 |
| 🔄 | 进行中 |
| ✅ | 已完成 |
| ⏸️ | 暂停 |
| ❌ | 取消 |
