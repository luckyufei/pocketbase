# Serverless vs Hooks 性能对比报告

## 执行环境

- **操作系统**: darwin
- **CPU**: arm64 (10 核)
- **Go 版本**: go1.24.0
- **测试时间**: 2026-01-09 23:12:43
- **总耗时**: 9m17.34146375s

## 性能对比

| 场景 | jsvm QPS | serverless QPS | 比率 | jsvm P99 | serverless P99 | 胜出 |
|------|----------|----------------|------|----------|----------------|------|
| http_handler | 34514.9 | 26102.0 | 75.6% | 38.0ms | 51.0ms | jsvm |
| db_hook | 42483.7 | 18090.6 | 42.6% | 8.0ms | 18.0ms | jsvm |
| compute | 15643.4 | 22587.6 | 144.4% | 2.0ms | 1.0ms | serverless |
| io_intensive | 31218.1 | 31857.9 | 102.0% | 11.0ms | 10.0ms | serverless |
| memory_pressure | 5156.7 | 4537.1 | 88.0% | 1.0ms | 2.0ms | jsvm |
| error_recovery | 5482.7 | 3484.9 | 63.6% | 0.0ms | 0.0ms | jsvm |

## 胜出统计

- **jsvm 胜出**: 24 个场景
- **serverless 胜出**: 12 个场景
- **总体性能胜出**: jsvm

## 关键发现

- jsvm 在大多数性能测试中胜出，适合对延迟敏感的应用

## 使用建议

| 场景 | 推荐 | 原因 |
|------|------|------|
| error_recovery | serverless | serverless 提供内存限制和错误隔离，更适合不可信代码 |
| http_handler | jsvm | jsvm 性能显著更高，适合对延迟敏感的场景 |
| db_hook | jsvm | jsvm 性能显著更高，适合对延迟敏感的场景 |
| compute | serverless | QuickJS 在计算密集型任务上表现更好 |
| io_intensive |  |  |
| memory_pressure | serverless | serverless 提供内存限制和错误隔离，更适合不可信代码 |

## 详细数据

### error_recovery

**jsvm:**
- 总请求: 10
- 成功率: 0.00%
- QPS: 5482.7
- 延迟 P50/P95/P99: 0.0/0.0/0.0ms

**serverless:**
- 总请求: 10
- 成功率: 0.00%
- QPS: 3484.9
- 延迟 P50/P95/P99: 0.0/0.0/0.0ms

### http_handler

**jsvm:**
- 总请求: 1035487
- 成功率: 0.00%
- QPS: 34514.9
- 延迟 P50/P95/P99: 2.0/20.0/38.0ms

**serverless:**
- 总请求: 783538
- 成功率: 0.00%
- QPS: 26102.0
- 延迟 P50/P95/P99: 3.0/27.0/51.0ms

### db_hook

**jsvm:**
- 总请求: 1274534
- 成功率: 0.00%
- QPS: 42483.7
- 延迟 P50/P95/P99: 0.0/3.0/8.0ms

**serverless:**
- 总请求: 542780
- 成功率: 0.00%
- QPS: 18090.6
- 延迟 P50/P95/P99: 1.0/10.0/18.0ms

### compute

**jsvm:**
- 总请求: 100
- 成功率: 0.00%
- QPS: 15643.4
- 延迟 P50/P95/P99: 0.0/1.0/2.0ms

**serverless:**
- 总请求: 100
- 成功率: 0.00%
- QPS: 22587.6
- 延迟 P50/P95/P99: 0.0/0.0/1.0ms

### io_intensive

**jsvm:**
- 总请求: 937209
- 成功率: 0.00%
- QPS: 31218.1
- 延迟 P50/P95/P99: 0.0/5.0/11.0ms

**serverless:**
- 总请求: 955838
- 成功率: 0.00%
- QPS: 31857.9
- 延迟 P50/P95/P99: 0.0/5.0/10.0ms

### memory_pressure

**jsvm:**
- 总请求: 10
- 成功率: 0.00%
- QPS: 5156.7
- 延迟 P50/P95/P99: 0.0/1.0/1.0ms

**serverless:**
- 总请求: 10
- 成功率: 0.00%
- QPS: 4537.1
- 延迟 P50/P95/P99: 0.0/2.0/2.0ms

